(function(){var m=function(){return this}();m.Deferred=typeof m.jQuery!=="undefined"&&typeof m.jQuery.Deferred!=="undefined"?m.jQuery.Deferred:function(){if(!(this instanceof arguments.callee))return new m.Deferred;var j=[0,[],[]],d=0,h,b=null,o,n=this,k=function(e,b,k){if(!d){d=e;h=b;for(e=j[e];e.length;)e.shift().apply(k,h);j=null;return n}},p=function(e,b){d==e?b.apply(this,h):d||j[e].push(b);return this};n.promise=function(e){if(!e&&b)return b;b=e?e:b?b:{};for(var d in o)o.hasOwnProperty(d)&&
(b[d]=o[d]);return b};n.resolve=function(){return k(1,arguments,b)};n.reject=function(){return k(2,arguments,b)};n.resolveWith=function(){var e=arguments.shift();return k(1,arguments,e)};n.rejectWith=function(){var e=arguments.shift();return k(2,arguments,e)};o={done:function(e){return p.call(this,1,e)},fail:function(e){return p.call(this,2,e)},then:function(e,b){return this.done(e).fail(b)},always:function(b){return this.then(b,b)},isResolved:function(){return d==1},isRejected:function(){return d==
2}}}})();(function(){for(var m=function(){return this}(),j=Array(256),d=0;d<256;d++){for(var h=d,b=0;b<8;b++)h=h&1?3988292384^h>>>1:h>>>1;j[d]=h}m.crc32=function(b){for(var d=-1,k=0,h=b.length;k<h;k++)d=d>>>8^j[(d^b.charCodeAt(k))&255];return d^-1}})();(function(){var m=function(){return this}(),j=m.APNG={},d=null;j.checkNativeFeatures=function(a){var b=!d,c=b?d=new Deferred:d;a&&c.promise().done(a);if(!b)return c.promise();var r={canvas:!1,apng:!1},q=document.createElement("canvas");if(typeof q.getContext=="undefined")c.resolve(r);else{r.canvas=!0;var e=new Image;e.onload=function(){var a=q.getContext("2d");a.drawImage(e,0,0);if(a.getImageData(0,0,1,1).data[3]===0)r.apng=!0;c.resolve(r)};e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACGFjVEwAAAABAAAAAcMq2TYAAAANSURBVAiZY2BgYPgPAAEEAQB9ssjfAAAAGmZjVEwAAAAAAAAAAQAAAAEAAAAAAAAAAAD6A+gBAbNU+2sAAAARZmRBVAAAAAEImWNgYGBgAAAABQAB6MzFdgAAAABJRU5ErkJggg=="}return c.promise()};
var h=null;j.ifNeeded=function(a){var b=!h,c=b?h=new Deferred:h;a&&c.promise().done(a);if(!b)return c.promise();if(location.protocol!="http:"&&location.protocol!="https:")return c.reject("apng-canvas doesn't work on pages loaded by '"+location.protocol+"' protocol"),c.promise();this.checkNativeFeatures().done(function(a){a.canvas&&!a.apng?c.resolve():(a.canvas||c.reject("Browser doesn't support canvas"),a.apng&&c.reject("Browser has native APNG support"))}).done(function(){c.reject()});return c.promise()};
j.createAPNGCanvas=function(a,b){var c=new Deferred;b&&c.promise().done(b);e(a).done(function(a){v(a).done(function(b){var e=document.createElement("canvas");e.width=b.width;e.height=b.height;if(b.isAnimated)w(b,e);else{var s=new Image;s.onload=function(){e.getContext("2d").drawImage(s,0,0)};b=new p;b.append(a);s.src=b.getUrl("image/png")}c.resolve(e)}).fail(function(a){c.reject(a)})}).fail(function(a){c.reject(a)});return c.promise()};j.replaceImage=function(a){return j.createAPNGCanvas(a.src).done(function(b){a.parentNode.insertBefore(b,
a);a.parentNode.removeChild(a)})};var b=function(a){for(var b=0,c=0;c<4;c++)b+=a.charCodeAt(c)<<(3-c)*8;return b},o=function(a){for(var b=0,c=0;c<2;c++)b+=a.charCodeAt(c)<<(1-c)*8;return b},n=function(a,b){var c="";c+=k(b.length);c+=a;c+=b;c+=k(crc32(a+b));return c},k=function(a){return String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255)},p=function(){this.parts=[]};p.prototype.append=function(a){this.parts.push(a)};p.prototype.getUrl=function(a){return"data:"+a+","+escape(this.parts.join(""))};
typeof XMLHttpRequest.prototype.responseBody!="undefined"&&typeof document.addEventListener!="undefined"&&document.addEventListener("DOMContentLoaded",function(){var a=document.createElement("script");a.setAttribute("type","text/vbscript");a.text="Function APNGIEBinaryToBinStr(Binary)\r\n   APNGIEBinaryToBinStr = CStr(Binary)\r\nEnd Function\r\n";document.body.appendChild(a)});var e=function(a){var b=new Deferred,c=new XMLHttpRequest,e=m.BlobBuilder||m.WebKitBlobBuilder,d=typeof this.responseBody!=
"undefined",h=typeof this.responseType!="undefined"&&typeof e!="undefined",g=typeof c.overrideMimeType!="undefined"&&!h;c.open("GET",a,!0);h?c.responseType="arraybuffer":g&&c.overrideMimeType("text/plain; charset=x-user-defined");c.onreadystatechange=function(){if(this.readyState==4&&this.status==200)if(h){var a=new e;a.append(this.response);var i=new FileReader;i.onload=function(){b.resolve(this.result)};i.readAsBinaryString(a.getBlob())}else{a="";if(d)for(var i=APNGIEBinaryToBinStr(this.responseBody),
g=0,l=i.length;g<l;g++){var k=i.charCodeAt(g);a+=String.fromCharCode(k&255,k>>8&255)}else{i=this.responseText;g=0;for(l=i.length;g<l;++g)a+=String.fromCharCode(i.charCodeAt(g)&255)}b.resolve(a)}else this.readyState==4&&b.reject(c)};c.send();return b.promise()},v=function(a){var e=new Deferred;if(a.substr(0,8)!="PNG\r\n\n")return e.reject("Invalid PNG file signature"),e.promise();var c={width:0,height:0,isAnimated:!1,numPlays:0,frames:[]},d,q="",h="",g=8,f=null;do{var i=b(a.substr(g,4)),j=a.substr(g+
4,4),l;switch(j){case "IHDR":d=l=a.substr(g+8,i);c.width=b(l.substr(0,4));c.height=b(l.substr(4,4));break;case "acTL":c.isAnimated=!0;c.numPlays=b(a.substr(g+8+4,4));break;case "fcTL":f&&c.frames.push(f);l=a.substr(g+8,i);f={};f.width=b(l.substr(4,4));f.height=b(l.substr(8,4));f.left=b(l.substr(12,4));f.top=b(l.substr(16,4));var m=o(l.substr(20,2)),t=o(l.substr(22,2));t==0&&(t=100);f.delay=1E3*m/t;f.disposeOp=l.charCodeAt(24);f.blendOp=l.charCodeAt(25);f.dataParts=[];break;case "fdAT":f&&f.dataParts.push(a.substr(g+
8+4,i-4));break;case "IDAT":f&&f.dataParts.push(a.substr(g+8,i));break;case "IEND":h=a.substr(g,i+12);break;default:q+=a.substr(g,i+12)}g+=12+i}while(j!="IEND"&&g<a.length);f&&c.frames.push(f);c.isAnimated||e.resolve(c);for(var u=0,a=0;a<c.frames.length;a++){g=new Image;f=c.frames[a];f.img=g;g.onload=function(){u++;u==c.frames.length&&e.resolve(c)};g.onerror=function(){e.reject("Image creation error")};i=new p;i.append("PNG\r\n\n");d=k(f.width)+k(f.height)+d.substr(8);i.append(n("IHDR",d));i.append(q);
for(j=0;j<f.dataParts.length;j++)i.append(n("IDAT",f.dataParts[j]));i.append(h);g.src=i.getUrl("image/png");delete f.dataParts}return e.promise()},w=function(a,b){var c=b.getContext("2d"),e=0,d=null,h=function(){var b=e++%a.frames.length,f=a.frames[b];if(b==0&&(c.clearRect(0,0,a.width,a.height),d=null,f.disposeOp==2))f.disposeOp=1;d&&d.disposeOp==1?c.clearRect(d.left,d.top,d.width,d.height):d&&d.disposeOp==2&&c.putImageData(d.iData,d.left,d.top);d=f;d.iData=null;if(d.disposeOp==2)d.iData=c.getImageData(f.left,
f.top,f.width,f.height);f.blendOp==0&&c.clearRect(f.left,f.top,f.width,f.height);c.drawImage(f.img,f.left,f.top);(a.numPlays==0||e/a.frames.length<a.numPlays)&&setTimeout(h,f.delay)};h()}})();
